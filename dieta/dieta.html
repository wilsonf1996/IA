<<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planilha de Dieta</title>
    <!-- Adicione as bibliotecas do Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.2/firebase-firestore.js"></script>
</head>
<body>

<h1>Planilha de Dieta</h1>

<div>
    <label for="alimentos">Alimentos (separados por vírgula): </label>
    <input type="text" id="alimentos">
</div>

<div>
    <label for="bebidas">Bebidas (separadas por vírgula): </label>
    <input type="text" id="bebidas">
</div>

<div>
    <label for="quantidadeAlimentos">Quantidade dos Alimentos: </label>
    <input type="text" id="quantidadeAlimentos">
</div>

<div>
    <label for="quantidadeBebidas">Quantidade das Bebidas: </label>
    <input type="text" id="quantidadeBebidas">
</div>

<div>
    <label for="horarioRefeicao">Horário da Refeição: </label>
    <input type="text" id="horarioRefeicao">
</div>

<div>
    <label for="semanaSelecionada">Semana Selecionada: </label>
    <input type="text" id="semanaSelecionada">
</div>

<button onclick="adicionarRefeicao()">Adicionar Refeição</button>

<div id="refeicoes"></div>

<script>
    // Configuração do Firebase do app da agenda semanal
    const firebaseConfig = {
        apiKey: "AIzaSyAIp-rFuZZsBCNVJ3pSge4TE-XUuwYygrI",
        authDomain: "agenda-6accc.firebaseapp.com",
        databaseURL: "https://agenda-6accc-default-rtdb.firebaseio.com",
        projectId: "agenda-6accc",
        storageBucket: "agenda-6accc.appspot.com",
        messagingSenderId: "794262176773",
        appId: "1:794262176773:web:c4e3837b29f635d5dc086c",
        measurementId: "G-CVBQ54PERH"
    };
    
    // Inicialização do Firebase
    const firebaseApp = firebase.initializeApp(firebaseConfig);
    const firestore = firebase.firestore();

    function adicionarRefeicao() {
        const alimentos = document.getElementById('alimentos').value.split(',');
        const bebidas = document.getElementById('bebidas').value.split(',');
        const quantidadeAlimentos = document.getElementById('quantidadeAlimentos').value;
        const quantidadeBebidas = document.getElementById('quantidadeBebidas').value;
        const horarioRefeicao = document.getElementById('horarioRefeicao').value;
        const semanaSelecionada = document.getElementById('semanaSelecionada').value;

        // Use os dados do Firebase do app da agenda semanal
        const agendaRef = firebase.database().ref(`/agenda/${semanaSelecionada}`);
        agendaRef.once('value').then(snapshot => {
            const dadosAgenda = snapshot.val();
            console.log('Dados da Agenda Semanal:', dadosAgenda);

            // Aqui você pode usar os dados da agenda conforme necessário
            // Por exemplo, você pode acessar dadosAgenda['1-1'] para obter o conteúdo da célula da primeira hora da segunda-feira

            // Agora você pode adicionar os dados da refeição ao Firestore
            firestore.collection(semanaSelecionada).add({
                alimentos: alimentos,
                bebidas: bebidas,
                quantidade_alimentos: quantidadeAlimentos,
                quantidade_bebidas: quantidadeBebidas,
                horario_refeicao: horarioRefeicao
            });

            limparCampos();
            atualizarRefeicoes();
        });
    }

    function limparCampos() {
        document.getElementById('alimentos').value = '';
        document.getElementById('bebidas').value = '';
        document.getElementById('quantidadeAlimentos').value = '';
        document.getElementById('quantidadeBebidas').value = '';
        document.getElementById('horarioRefeicao').value = '';
        document.getElementById('semanaSelecionada').value = '';
    }

    function atualizarRefeicoes() {
        const refeicoesDiv = document.getElementById('refeicoes');

        // Aqui você pode modificar a consulta para recuperar os dados do Firestore conforme necessário
        firestore.collection('semana1').onSnapshot(snapshot => {
            refeicoesDiv.innerHTML = ''; // Limpa a exibição anterior

            snapshot.forEach(refeicao => {
                const dados = refeicao.data();
                const refeicaoHtml = `
                    <div>
                        <p>Alimentos: ${dados.alimentos.join(', ')}</p>
                        <p>Bebidas: ${dados.bebidas.join(', ')}</p>
                        <p>Quantidade Alimentos: ${dados.quantidade_alimentos}</p>
                        <p>Quantidade Bebidas: ${dados.quantidade_bebidas}</p>
                        <p>Horário Refeição: ${dados.horario_refeicao}</p>
                    </div>
                `;
                refeicoesDiv.innerHTML += refeicaoHtml;
            });
        });
    }

    // Chama a função para exibir as refeições existentes
    atualizarRefeicoes();
</script>

</body>
</html>
